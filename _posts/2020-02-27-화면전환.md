---
layout: posts
title: 화면전환
category: iOS
tags: [iOS]
---
iOS에서 화면전환은 크게 2가지가 있다.

1. 소스 코드에서 구현하는 방식 → 프로그래밍적으로 화면 전환, 동적으로 화면 전환
2. 스토리보드에서 구현하는 방식 → GUI 방식으로 화면 전환, 정적으로 화면 전환

### iOS 화면 전환 방식
1. 뷰 컨트롤러의 뷰 위에 다른 뷰를 가져와 바꿔치기하기
2. 뷰 컨트롤러에서 다른 뷰 컨트롤러를 호출하여 화면 전환하기
3. 내비게이션 컨트롤러를 사용하여 화면 전환하기
4. 화면 전환용 객체 세그웨이를 사용하여 화면 전환하기

### iOS 화면 전환 특성
1. 다음 화면으로 이동하는 방법과 이전 화면으로 되돌아가는 방법이 다름
2. 화면 전환 방식에 따라 이전 화면으로 되돌아가는 방법이 다름

## 뷰 컨트롤러 직접 호출에 의한 화면 전환
`present(_:animated:)` : UIViewController에 정의된 화면 전환 메소드. 호출 대상은 뷰 컨트롤러 자신
`present(<새로운 뷰 컨트롤러 인스턴스>, animated:<애니메이션 여부>)`
`present(_:animated:completion:)` : 화면 전환이 완료되는 시점에 특정 로직을 실행해 주어야 할 경우

화면 전환은 비동기 방식으로 동작하기 때문에 클로저나 함수 형식으로 작성하여 세 번째 인자값에 넣으면 됨.
present 메소드를 이용한 화면 전환은 기존의 뷰 컨트롤러를 그대로 둔 채, 새로운 뷰 컨트롤러의 화면으로 덮는 방식

`dissmiss(animated:)`: present 메소드를 이용했다면 이전 화면으로 복귀할 때 사용하는 메소드.
`dissmiss(animated:completion:):` 화면 복귀 후 특정 로직을 싱행해 주어야 할 경우

현재의 뷰 컨트롤러를 표시해준 컨트롤러(self.presentingViewController)에서 호출

`instantiateViewController(withIdentifier:)` : 인자값으로 입력받은 아이디로 스토리보드에서 뷰 컨트롤러를 찾고 연결된 클래스를 읽어와 뷰 컨트롤러에 대한 인스턴스 생성.
`modalTransitionStyle` : 화면 전환 효과를 주는 속성. 

전환 효과는 UIModalTransitionStyle 객체에 enum 타입으로 정의되어 있으며 4개의 기본 전환 스타일이 제공.

Unwind : iOS 앱에서 이전 화면으로 돌아가는 것. Unwind를 위한 별도의 메소드가 제공되기 때문에, 화면을 복귀할 때는 반드시 이 메소드를 이용하여 이전 화면으로 되돌아가야 합니다.

프레젠테이션 방식으로 화면을 전환할 경우, 뷰 컨트롤러의 포인터는 차례로 프레젠테이션 체인에 저장됩니다. 이전화면으로 되돌아가는 과정은 이 프레젠테이션 체인에 저장된 뷰 컨트롤러 포인터를 제거하는 방식으로 이루어지며 ARC 시스템에 의해 메모리에서 차례로 해제됩니다.

화면 전환 방식이 달라지면 그것에 맞는 Unwind 메소드도 달라집니다.

## 내비게이션 컨트롤러를 이용한 화면 전환
내비게이션 컨트롤러는 화면에 현재 표시되고 있는 뷰 컨트롤러들을 **내비게이션 스택(Navigation Stack)** 을 이용하여 관리합니다. 
최상위에 있는 뷰 컨트롤러가 현재 화면에 표시되고 있는 뷰 컨트롤러고 가장 아래에 있는 첫 번째 뷰 컨트롤러는 루트 뷰 컨트롤러입니다.

`pushViewController(_:animated:)` : 스택의 최상위에 뷰 컨트롤러 추가. 호출 대상은 내비게이션 컨트롤러
`popViewController(animated:)` : 스택의 최상위 뷰 컨트롤러 제거

내비게이션 컨트롤러(self.navigationController)에서 호출

## 세그웨이를 이용한 화면 전환
세그웨이(Segue)라고 불리는 이 객체는 스토리보드에서 뷰 컨트롤러 사이의 연결 관계 및 화면 전환을 관리하는 역할을 합니다.
뷰 컨트롤러와 뷰 컨트롤러 또는 화면 전환의 매개체가 되는 버튼과 뷰 컨트롤러 사이를 직접 연결하는 식으로 관계를 구성합니다.
세그웨이는 한쪽으로만 통행할 수 있습니다.

- Manual Segue : 출발점이 뷰 컨트롤러 자체인 경우
- Action Segue, Trigger Segue: 버튼 등이 출발점인 경우

Manual Segue를 실행하려면 UIKit 프레임워크에 정의된 `performSegue(withIdentifier:sender:)` 메소드를 사용합니다.

### Action Segue
아주 간단하게 사용 할 수 있음.
조건 여부와 관계없이 무조건 특정 페이지로 이동하게 처리할 때 사용.

### Manual Segue
세그웨이를 사용하면서 조건에 따라 제어하고 싶을 경우 사용
Action Segue와 달리 뷰 컨트롤러와 뷰 컨트롤러 사이에 연결되는 수동 실행 세그웨이.
`performSegue(withIdentifier: <세그웨이 식별자>, sender : <세그웨이 실행 객체>)`

### Custom Segue
UIStroboardSegue클래스를 서브클래싱하여 새로운 기능을 갖춘 세그웨이 객체를 정의할 수 있다.
`self.source`: 출발지 속성
`self.destination`: 목적지 속성

```swift    
    UIView.transition(from: <출발지 뷰>
                                        to: <목적지 뷰>
                                        duration: <화면 전환에 소요되는 시간(단위:초)>
                                        options: <애니메이션 전환 옵션>)
    
    UIView.transition(from: <출발지 뷰
                                        to: <목적지 뷰>
                                        duration: <화면 전환에 소요되는 시간(단위:초)>
                                        options: <애니메이션 전환 옵션>
                                        completion: <화면 전환이 끝난 후 실행할 함수나 클로저 구문>)
```

### Pre-Process Method 활용
코코아 터치 프레임워크는 세그웨이가 실행되기 전에 특정한 메소드를 호출하도록 설계되어 있는데, 이를 전처리 메소드라고 합니다. 이를 이용해 세그웨이를 이용하여 화면을 전환할 때 특별한 처리를 해줄 수 있습니다.

`prepare(for segue: UIStoryboardSegue, sender: Any?) {...}`

이 메소드는 구현해 놓으면 시스템이 호출합니다. 또한 이 전처리 메소드를 여러 세그웨이가 공유합니다.

첫번 째 매개변수: 메소드를 호출한 세그웨이 객체
두번 째 매개변수: 세그웨이를 실행하는 트리거에 대한 정보

전처리 메소드는 대부분 다음 화면으로 값을 전달하는 데에 사용됩니다.
